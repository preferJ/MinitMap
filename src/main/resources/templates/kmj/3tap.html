<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script
            src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=l7xx71377ca4d61b42018b3da0ede8c234fb"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script></head>
<script th:inline="javascript">
    var map_count = 0;
    var page_lat = [[${page_lat}]];
    var page_lng = [[${page_lng}]];
    var map;
    // 화면 크기가 변경될때마다 함수 호출
    $(window).resize(function (){
        if(map_count == 0) {
            var width_size = window.outerWidth;
            // 화면의 height값을 가져오기
            var height_size = window.outerHeight;
            var mapResize = document.getElementById('map_div');//map의 div
            var sidebarResize = document.getElementById("sidebar");
            if ((screen.availHeight || screen.height - 30) <= window.innerHeight) {
                mapResize.style.width = width_size - 320 + "px";//map의 height 변경
                mapResize.style.height = height_size - 147 - 4 + "px";//map의 height 변경
                sidebarResize.style.height = height_size - 147 - 4 + "px";
                alert("전체화면은 지원하지 않습니다.")
            } else if (width_size == 1920) {
                mapResize.style.width = width_size - 320 + "px";//map의 height 변경
                mapResize.style.height = height_size - 147 - 4 + "px";//map의 height 변경
                sidebarResize.style.height = height_size - 147 - 4 + "px";
            } else {
                mapResize.style.width = width_size - 336 + "px";//map의 height 변경
                mapResize.style.height = height_size - 164 - 4 + "px";//map의 height 변경
                sidebarResize.style.height = height_size - 164 - 4 + "px";
            }
        }else if(map_count == 1){
            var width_size = window.outerWidth;
            // 화면의 height값을 가져오기
            var height_size = window.outerHeight;
            var mapResize = document.getElementById('map_div');//map의 div
            var sidebarResize = document.getElementById("sidebar");
            if ((screen.availHeight || screen.height - 30) <= window.innerHeight) {
                mapResize.style.width = width_size - 0 + "px";//map의 height 변경
                mapResize.style.height = height_size - 147 - 4 + "px";//map의 height 변경
                sidebarResize.style.height = height_size - 147 - 4 + "px";
                alert("전체화면은 지원하지 않습니다.")
            } else if (width_size == 1920) {
                mapResize.style.width = width_size - 0 + "px";//map의 height 변경
                mapResize.style.height = height_size - 147 - 4 + "px";//map의 height 변경
                sidebarResize.style.height = height_size - 147 - 4 + "px";
            } else {
                mapResize.style.width = width_size - 16 + "px";//map의 height 변경
                mapResize.style.height = height_size - 164 - 4 + "px";//map의 height 변경
                sidebarResize.style.height = height_size - 164 - 4 + "px";
            }
        }
    });
    function initTmap() {
        tapCheck("tap3");
        var request_lat;
        var request_lng;
        if (page_lat == 0 && page_lng == 0) {
            request_lat = 37.570028;
            request_lng = 126.989072;
        } else {
            request_lat = page_lat;
            request_lng = page_lng;
        }
        console.log(page_lat, page_lng);
        sidebarResize = document.getElementById("sidebar");
        var width_size = window.outerWidth;
        var height_size = window.outerHeight;
        if(width_size == 1920 ){
            sidebarResize.style.height = height_size - 147 - 4  + "px";
            // 1. 지도 띄우기
            map = new Tmapv2.Map("map_div", {
                center: new Tmapv2.LatLng(request_lat, request_lng),
                width: width_size - 320 + "px",
                height: height_size - 147 - 6 + "px",
                zoom: [[${page_zoom}]],
                zoomControl: true,
                scrollwheel: true
            });
        }else {
            sidebarResize.style.height = height_size - 164 - 4 + "px";
            // 1. 지도 띄우기
            map = new Tmapv2.Map("map_div", {
                center: new Tmapv2.LatLng(request_lat, request_lng),
                width: width_size - 336 + "px",
                height: height_size - 164 - 6 + "px",
                zoom: [[${page_zoom}]],
                zoomControl: true,
                scrollwheel: true
            });
        }

    }
    const boardAll = () => {
        location.href = "/board/findAll";
    }
    const trafficAll = () => {


    }
    const freeAll = () => {

    }
    const adminAll = () => {

    }
    const goBoardPages = () => {
        location.href = "/board";
    }
</script>
<style>
    body {
        -ms-overflow-style: none;
        padding: 0;
        margin: 0;
        overflow: hidden;
    }
    ::-webkit-scrollbar {
        display: none;
    }
    #map_div {
        float: right;
        width: 100%;
        box-sizing: border-box;
    }

    #sidebar {
        float: left;
        width: 320px;
        height: 818px;
        background-color: #c7dbd2;
        border: 2px solid black;
        border-top: none;
    }
    #boardSave {
        background-color: white;
        border: 1px solid #20c997;
        margin: 3%;
        height: 95%;
        padding: 10%;
    }
    .hstack {
        display: flex;
        flex-direction: row;
        align-items: center;
        align-self: stretch;
    }

</style>
<body>
<th:block th:replace="/kmj/header :: header"></th:block>
</body>
<div id="sidebar">
    <div style="float: right"></div>
    <div id="boardSave" style="text-align: center">
    <div class="container">
        <h4 style="text-align: center">게시글 목록</h4>
        <select name="" id="" style="float:left" class="btn btn-sm btn-outline-secondary dropdown-toggle">
            <option value="">카테고리</option>
            <option value="">전체</option>
            <option value="">신호</option>
            <option value="">자유</option>
            <option value="">공지</option>
        </select>
        <table class="table">
            <tr>
                <th>카테고리</th>
                <th>글 제목</th>
                <th>작성자</th>
            </tr>
            <tr th:each="board: ${boardList}">
                <td th:text="${board.boardType}"></td>
                <a href="/board/findById"><td th:text="${board.boardTitle}"></td></a>
                <td th:text="${board.memberNickname}"></td>
            </tr>
        </table>
    </div>
        <button onclick="goBoardPages()">게시판 이동</button>
    </div>
</div>

<body onload="initTmap();">
<div id="map_div"></div>
</body>
</html>